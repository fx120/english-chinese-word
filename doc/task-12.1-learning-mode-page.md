# Task 12.1 实现学习模式选择页面

## 任务概述

实现学习模式选择页面，允许用户在随机学习和顺序学习两种模式之间进行选择。

## 实施时间

2024年（具体日期根据实际情况）

## 需求关联

- 需求 7.1: 随机学习模式
- 需求 8.1: 顺序学习模式

## 实施内容

### 1. 创建学习模式选择页面

**文件**: `app/lib/ui/pages/learning_mode_page.dart`

#### 功能特性

1. **词表信息展示**
   - 显示词表名称和描述
   - 显示总单词数、已学习数、未学习数
   - 使用卡片布局，清晰展示信息

2. **学习进度展示**
   - 显示学习进度百分比
   - 使用进度条可视化展示
   - 显示已掌握和需复习单词数量
   - 使用不同颜色区分状态（绿色=已掌握，橙色=需复习）

3. **学习模式选择**
   - **随机学习模式**
     - 图标：shuffle（橙色）
     - 描述：随机抽取未学习的单词，增加学习的趣味性和挑战性
   - **顺序学习模式**
     - 图标：format_list_numbered（绿色）
     - 描述：按词表顺序学习单词，系统化地掌握词汇

4. **交互设计**
   - 点击模式卡片启动对应的学习模式
   - 如果没有未学习的单词，禁用模式选择
   - 提供友好的错误提示

#### 数据加载

页面初始化时从 `LearningManager` 加载以下数据：
- 学习进度百分比
- 未学习单词数量
- 已掌握单词数量
- 需复习单词数量

#### UI 设计

1. **顶部 AppBar**
   - 标题：选择学习模式
   - 背景色：蓝色
   - 返回按钮

2. **词表信息卡片**
   - 词表图标和名称
   - 词表描述（如果有）
   - 三个统计指标：总单词、已学习、未学习
   - 使用图标和颜色区分不同指标

3. **学习进度卡片**
   - 进度标题和百分比
   - 进度条（蓝色）
   - 已掌握和需复习的详细数据

4. **学习模式选择区域**
   - 标题：选择学习模式
   - 两个模式卡片，每个包含：
     - 彩色图标
     - 模式名称
     - 模式描述
     - 右箭头指示器

### 2. 更新 LearningProvider

**文件**: `app/lib/providers/learning_provider.dart`

添加了 `learningManager` getter，使页面可以访问 `LearningManager` 实例。

```dart
/// 获取学习管理器
LearningManager get learningManager => _learningManager;
```

## 技术实现

### 状态管理

使用 `StatefulWidget` 管理页面状态：
- `_isLoading`: 加载状态
- `_totalWords`: 总单词数
- `_learnedWords`: 已学习单词数
- `_masteredWords`: 已掌握单词数
- `_needReviewWords`: 需复习单词数
- `_unlearnedWords`: 未学习单词数
- `_progress`: 学习进度百分比

### 依赖注入

通过 `Provider` 获取 `LearningProvider`：
```dart
final learningManager = context.read<LearningProvider>().learningManager;
```

### 错误处理

- 加载失败时显示错误提示
- 没有未学习单词时禁用模式选择
- 使用 SnackBar 显示友好的错误信息

## 集成说明

### 导航到此页面

从词表详情页或词表列表页导航：

```dart
Navigator.push(
  context,
  MaterialPageRoute(
    builder: (context) => LearningModePage(
      vocabularyList: vocabularyList,
    ),
  ),
);
```

### 后续任务

此页面为任务 12.2（实现学习卡片页面）做准备。当用户选择学习模式后，将导航到学习卡片页面开始学习。

目前学习卡片页面尚未实现，点击模式时会显示提示信息。

## 测试建议

### 手动测试

1. **正常流程测试**
   - 打开有未学习单词的词表
   - 验证词表信息正确显示
   - 验证学习进度正确计算
   - 点击随机学习模式
   - 点击顺序学习模式

2. **边界情况测试**
   - 测试没有未学习单词的词表（应禁用模式选择）
   - 测试空词表
   - 测试所有单词已掌握的词表

3. **UI 测试**
   - 验证卡片布局正确
   - 验证进度条显示正确
   - 验证颜色和图标正确
   - 验证响应式布局

### 单元测试（可选）

可以为以下功能编写单元测试：
- 学习进度计算
- 状态更新逻辑
- 错误处理

## 已知限制

1. **学习卡片页面未实现**
   - 点击学习模式时显示提示信息
   - 将在任务 12.2 中实现

2. **刷新机制**
   - 目前没有下拉刷新功能
   - 返回页面时不会自动刷新数据

## 文件清单

### 新增文件
- `app/lib/ui/pages/learning_mode_page.dart` - 学习模式选择页面

### 修改文件
- `app/lib/providers/learning_provider.dart` - 添加 learningManager getter

### 文档文件
- `doc/task-12.1-learning-mode-page.md` - 本文档

## 验收标准

- [x] 创建 `app/lib/ui/pages/learning_mode_page.dart`
- [x] 显示随机学习和顺序学习两个选项
- [x] 显示当前词表信息
- [x] 显示学习进度
- [x] 集成 LearningManager
- [x] 集成 VocabularyManager
- [x] 代码通过 Dart 诊断检查
- [x] 遵循项目 UI 设计规范
- [ ] 导航到学习卡片页面（待任务 12.2 实现）

## 总结

任务 12.1 已成功完成。学习模式选择页面提供了清晰的界面，展示词表信息和学习进度，允许用户选择学习模式。页面设计遵循了项目的 UI 规范，与其他页面保持一致的风格。

下一步将实现任务 12.2（学习卡片页面），完成完整的学习流程。
